
class Sensor {

//Variable pour la définition de l'indicateur temps réel
int posx;
int posy; 
String title; 
String unity;
String[] scale;
Table table;
String variable;
int sizeWidth;
int sizeHeight;


// Variable locale
float xi, x0;
float yi, y0;
int i = 0;

Sensor(String _title, String _unity, String[] _scale, Table _table, String _variable, int _posx, int _posy, int _sizeWidth, int _sizeHeight){
  title = _title ;
  unity = _unity;
  scale = _scale;
  table = _table;
  variable = _variable;
  posx = _posx;
  posy = _posy;
  sizeWidth = _sizeWidth;
  sizeHeight = _sizeHeight;
}

void drawSensor(int row){
  createBackground();
  moveNeedle(row);
}

//Création du fond
void createBackground(){
    
    //origine du cercle des arcs
    x0 = posx + sizeWidth/2;
    y0 = posy + sizeHeight/2;
    
    // Jauge de constitué d'un titre, d'un indicateur et d'une jauge
    // contenu dans une fenêtre de 200h * 250l
     //Titre 
    pushStyle();
      // Masque pour le rafraichissement
      fill(240);
      stroke(150);
      rect(posx - 25, posy - 20, sizeWidth+120-45, (sizeHeight+120)/2-15);
      //Indicateurs
      pushStyle();
        textSize(20);
        fill(0);
        textSize(15);
        text(title + " :", x0 - (sizeHeight/2 + 20) ,y0 + 20);
        text(unity, x0 + 70, y0 + 20);
      popStyle();
    popStyle();
    
    //3 Arcs consécutifs et de couleur différente pour former une jauge de 180°
    //indication de l'échelle 
    pushStyle();
      textSize(10);
      smooth();
      strokeWeight(5);
      strokeCap(ROUND);
      noFill();
      smooth();
      pushStyle();
       fill(1);
       ellipse(x0-1, y0-1, 2, 2);
      popStyle();
      strokeWeight(15);
      strokeCap(ROUND);
      pushStyle();
       stroke(#de2d26);
       arc(x0, y0, sizeWidth, sizeHeight, PI + 11*PI/12 , 2*PI);
       xi = 85 * cos(0);
       yi = 85 * sin(0);
       fill(#de2d26);
       text(scale[2], x0 + xi, y0 - yi);
      popStyle();
      pushStyle();
       stroke(#fec44f);
       arc(x0, y0, sizeWidth, sizeHeight, PI + 2*PI/3, PI + 11*PI/12);
       xi = 85 * cos(PI/12);
       yi = 85 * sin(PI/12);
       fill(#fec44f);
       text(scale[1], x0 + xi, y0 - yi);
      popStyle();
      pushStyle();
       stroke(#31a354);
       arc(x0, y0, sizeWidth, sizeHeight, PI, PI + 2*PI/3);
       xi = 85 * cos(PI/3);
       yi = 85 * sin(PI/3);
       fill(#31a354);
       text(scale[0], x0 + xi, y0 - yi);
      popStyle();
    popStyle();
  }
  
  //Mouvement des aiguilles
  void moveNeedle(int row){
    int indice = 0;
    indice = table.getInt(row, variable);
    x0 = posx + sizeWidth/2;
    y0 = posy + sizeHeight/2;
    float borderMin = 0f;
    float borderMax = int(scale[2]);
    float coef = borderMax - borderMin;
    float theta = indice * PI / coef;
    xi = (sizeHeight/2) * -cos(theta);
    yi = (sizeHeight/2) * sin(theta);
    line(x0,y0,x0 + xi, y0 - yi);
    pushStyle();
      textSize(20);
      fill(0);
      text(Integer.toString(indice), x0+30, y0 + 20);
    popStyle();
  }
  
  /*Setters des 7 arguments du constructor
  title 
  unity
  scale
  table
  variable
  posx
  posy*/
  
  public void setTitle (String _title){
    title = _title;
  }
  public void setUnity (String _unity){
    unity = _unity;
  }
  public void setScale (String[] _scale){
    scale = _scale;
  }
  public void setTable (Table _table){
    table = _table;
  }
  public void setVariable (String _variable){
    variable = _variable;
  }
  public void setPosX (int _posx){
    posx = _posx;
  }
  public void setPosY (int _posy){
    posy = _posy;
  }
  
  /*Getters des 7 arguments du constructor
  title 
  unity
  scale
  table
  variable
  posx
  posy*/
  
  public String getTitle (){
    return title;
  }
  public String getUnity (){
    return unity;
  }
  public String[] getScale (){
    return scale;
  }
  public Table getTable (){
    return table;
  }
  public String getVariable (){
    return variable;
  }
  public int getPosX (){
    return posx;
  }
  public int getPosY (){
    return posy;
  }
  
}
